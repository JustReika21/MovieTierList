{% extends 'base.html' %}
{% load static %}
{% block content %}
    <link href="{% static 'css/reviews/review_create.css' %}" rel="stylesheet">
    <title>Create review</title>

    <form
        id="createForm"
        action="{% url 'api:review-list' %}"
        method="post"
        enctype="multipart/form-data"
        data-redirect-url="{% url 'user_profile:user-profile' request.user.username %}"
    >
        {% csrf_token %}

        <div class="item-info-container">
            <aside class="item-info-cover-wrapper">
                <input type="file" name="cover" id="id_cover" accept="image/*" hidden>

                <div class="cover-upload" id="coverUpload" role="button" tabindex="0" aria-label="Choose cover">
                    <img id="coverPreview" class="item-info-cover" src="{% static 'img/plus.png' %}" alt="Choose cover">
                    <span id="coverText" class="cover-text">Choose cover</span>
                </div>

                <button id="removeButton" type="button" class="btn-primary" style="margin-top: auto">Remove cover</button>
            </aside>

            <div class="item-info-content">
                <h1 class="item-info-title">Create Review</h1>

                <label for="id_title">Title</label>
                <input type="text" name="title" id="id_title" maxlength="127" required>

                <label for="id_description">Description</label>
                <textarea name="description" id="id_description"></textarea>

                <label for="id_rating">Rating</label>
                <select name="rating" id="id_rating" required>
                    {% for rating in ratings %}
                        <option value="{{ rating }}">{{ rating }}</option>
                    {% endfor %}
                </select>

                <label for="id_type">Type</label>
                <select name="type" id="id_type" required>
                    {% for type in types %}
                        <option value="{{ type.id }}">{{ type.name }}</option>
                    {% endfor %}
                </select>

                <label for="tagInput">Tags</label>
                <div class="tag-input-wrapper">
                    <input type="text" id="tagInput" placeholder="Type to search tags...">
                    <div id="tagSuggestions" class="suggestions"></div>
                </div>
                <div id="selectedTags" class="selected-tags"></div>
                <div id="hiddenTagsContainer"></div>
                
                <input type="hidden" name="user" id="user" value="{{ request.user.id }}">
                <div class="item-actions">
                    <button type="submit" class="btn-primary" style="margin-top: auto;">Save</button>
                </div>
            </div>
        </div>
    </form>
    
    <script src="{% static 'js/reviews/create.js' %}"></script>
    <script src="{% static 'js/reviews/image_preview.js' %}"></script>
    <script src="{% static 'js/reviews/tag_search.js' %}"></script>
{% endblock %}
